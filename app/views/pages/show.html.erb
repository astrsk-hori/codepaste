<div>
  <span class="col-md-2">
    <div class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown">目次 <span class="caret"></span></a>
      <ul class="dropdown-menu" role="menu">
        <% show_html, h_list = show_markdown("# #{@page.title}\n #{@page.body}") %>
        <% if h_list.present? %>
          <% h_list.each_with_index do |v, k| %>
            <li>
              <%= link_to "#header_no_#{k + 1}" do %>
                <%= %[#{"&nbsp;" * (v[:level] - 1)}].html_safe %><%= v[:text] %>
              <% end %>
            </li>
          <% end %>
        <% end %>
      </ul>
    </div>
  </span>
  <span class="col-md-8">
    <p>
      <%= view_tags @page.tag.split(',') %>
    </p>
  </span>
  <span class="col-md-2 text-right">
    <p>
      <% if @page.user_id == current_user.id || @page.user.blank? %>
        <%= link_to 'Destroy', @page, method: :delete, data: { confirm: 'Are you sure?' } %> |
        <%= link_to 'Edit', edit_page_path(@page), {role: "button"} %>
        <br />
        <br />
      <% end %>
      <%= @page.user.try(:name) || 'deleted_user' %> &nbsp;&nbsp;<%= gravatar_for(@page.user) %>
    </p>
  </span>
</div>
<div id="markdown">
  <hr>
  <p>
  <%= show_html %>
  </p>
</div>
<br />
<br />
<% @comments.each do |v| %>
  <hr>
  <div class="clearfix">
    <div class=".pull-left">
      <%= markdown v.comment %>
    </div>
    <br />
    <br />
    <div class=".pull-left">
      <%= link_to 'Destroy', page_comments_path(page_id: @page.id, id: v.id), method: :delete, data: { confirm: 'Are you sure?' } %>&nbsp;&nbsp;
      <%= gravatar_for(v.user) %>&nbsp;&nbsp;<strong><%= v.user.try(:name)||'deleted_user' %></strong>&nbsp; <%= v.created_at.to_time.strftime('%Y/%m/%d %H:%M:%S') %>
    </div>
  </div>
<% end %>
<br />
<br />
<hr>
<%= render 'comment_form' %>
<br />
<br />

<%= link_to 'Back To List.', pages_path, {class: "btn btn-default active",  role: "button"} %>
<br />
<br />
